<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Universe Modeler - Jadon Koegel (V.1)</title>
		<style>
			body { margin: 0; }
		</style>

		<!-- Virtual Method of using JS Files from: https://stackoverflow.com/questions/46349370/javascript-file-not-found-using-relative-path-during-flask-render-template -->
		<!-- here:-->
		<script src="{{ url_for('static', filename='js/massiveBody.js')}}"></script>
		<script src="{{ url_for('static', filename='js/three.js')}}"></script>

	</head>
	<body>
		<!-- Direct Inclusiuon of Javascript Libraries for Local Hosting Testing  -->
		<script src="/static/js/massiveBody.js"></script>
		<script src="/static/js/three.js"></script>
	
		<!-- Main Program Script Starts Here: -->
		<script>
			const scene = new THREE.Scene();
			const camera = new THREE.PerspectiveCamera( 75 /*(Field of View in deg.)*/, window.innerWidth / window.innerHeight /*Just keep these settings don't want image to look squished)*/, 0.1 /*(Near clipping distance)*/, 1000/*(Far clipping distance)*/ );

			const renderer = new THREE.WebGLRenderer();
			renderer.setSize( window.innerWidth, window.innerHeight );
			/* For lower resolution:
				setSize(window.innerWidth/2, window.innerHeight/2, false)
			*/
			document.body.appendChild( renderer.domElement );

			//https://medium.com/nerd-for-tech/getting-started-with-your-first-three-js-project-part-two-the-build-3fd9a2f21418
			renderer.setClearColor("#233143");
			const axesHelper = new THREE.AxesHelper(5);
			scene.add(axesHelper);  //X == red, Y == green, Z == blue

			//First central sphere
			const geometry = new THREE.SphereGeometry(1, 32, 16);
			const material = new THREE.MeshLambertMaterial( { color: 0x58286d /*Purple*/ } );
			const sphere = new THREE.Mesh( geometry, material );
			scene.add( sphere );
			Ignite(3);

			camera.position.z = 10;

			// const light = new THREE.PointLight(0xffffff, 1, 100);
			// light.position.set(1,1,1);
			// scene.add(light);

			//Math Constants
			let count = 1;
			const G = 6.6743e-11; //Gravitational Constant
			const M = 17000000; //Massive body mass (this is what my particle orbits)

			//New Massive Body
			const MB = new massiveBody(1.47095, 11, 0, 0, 0, 0, 3.0290, 4, 1.989, 30);

			//Orbiting Body Geometry
			const geometry1 = new THREE.SphereGeometry(0.2, 32, 16);
			const material1 = new THREE.MeshLambertMaterial( { color: 0x58286d /*Purple*/ } );
			const sphere1 = new THREE.Mesh( geometry1, material1 );
			scene.add( sphere1 );

			function animate() {
				count++;
				
				if(count > 1){
					MB.calcParams()
					//console.log("X: " + MB.X + "e" + MB.Xe);
					sphere1.position.x = MB.XAdj*4;
					sphere1.position.y = MB.YAdj*4;

					count = 0;
				}

				sphere.rotation.x -= 0.05;
				sphere.rotation.y -= 0.05;
				requestAnimationFrame( animate );
				renderer.render ( scene, camera );
			}

			animate();

			function Ignite(radius){
				const lights = [];
				for(i = 0; i <6; i++){
					lights[i] = new THREE.PointLight(0xFFFFFF, 3, 100);	
					if(i < 2){
						if(i % 2 == 1){
							lights[i].position.set(radius, 0, 0);
							scene.add(lights[i]);
						}
						else{
							lights[i].position.set(-radius, 0, 0);
							scene.add(lights[i]);
						}
					}	
					if(i < 4){
						if(i % 2 == 1){
							lights[i].position.set(0, radius, 0);
							scene.add(lights[i]);
						}
						else{
							lights[i].position.set(0, -radius, 0);
							scene.add(lights[i]);
						}
					}
					else{
						if(i % 2 == 1){
							lights[i].position.set(0, 0, radius);
							scene.add(lights[i]);
						}
						else{
							lights[i].position.set(0, 0, -radius);
							scene.add(lights[i]);
						}
					}
				}



			    // const light = new THREE.PointLight(0xffffff, 5, 100);
			    // let xyz = [0,0,0];
			    // while(xyz[2] == 0 || xyz[1]==0 || xyz[0]==0){
			    //     if(xyz[0] == 1){
			    //         const light = new THREE.PointLight(0xFFFFFF, 1, 100);
			    //         light.position.set(5, 5, 5);
			    //         scene.add(light);
			    //     }
			    //     for(i = 0; i < 3; i++){
			    //         if(xyz[i] == 1){
			    //             xyz[i] = 0;
			    //         }
			    //         else{
			    //             xyz[i] = 1;
			    //             break;
			    //         }
			    //     }
			    // }
			}
		</script>
	</body>
	
</html>